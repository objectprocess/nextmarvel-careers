<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Careers - Your Company</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            color: #333;
            background: #fafafa;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        /* Header */
        .header {
            background: white;
            border-bottom: 1px solid #e0e0e0;
            padding: 16px 0;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header-content {
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 24px;
            font-weight: 600;
            color: #4a5568;
            text-decoration: none;
        }

        .logo-icon {
            width: 32px;
            height: 32px;
            background: #e53e3e;
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 16px;
            font-family: Arial, sans-serif;
        }

        .logo-icon img {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }

        .back-arrow {
            display: none;
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            padding: 8px;
            border-radius: 4px;
            color: #666;
        }

        .back-arrow:hover {
            background: #f5f5f5;
        }

        /* Home Page */
        .home-page {
            display: block;
        }

        .hero-section {
            background: white;
            padding: 60px 0 40px;
            text-align: center;
            border-bottom: 1px solid #e0e0e0;
        }

        .hero-title {
            font-size: 48px;
            font-weight: 700;
            color: #2d3748;
            margin-bottom: 16px;
        }

        .hero-subtitle {
            font-size: 20px;
            color: #718096;
            max-width: 600px;
            margin: 0 auto;
        }

        .filters-section {
            background: white;
            padding: 32px 0;
            border-bottom: 1px solid #e0e0e0;
        }

        .filters {
            display: flex;
            gap: 20px;
            align-items: center;
        }

        .filter-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .filter-label {
            font-size: 14px;
            font-weight: 500;
            color: #4a5568;
        }

        .filter-select {
            padding: 12px 16px;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            font-size: 14px;
            background: white;
            min-width: 180px;
            cursor: pointer;
        }

        .filter-select:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .jobs-section {
            padding: 40px 0;
        }

        .jobs-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(360px, 1fr));
            gap: 24px;
            margin-top: 24px;
        }

        .job-card {
            background: white;
            border: 1px solid #e2e8f0;
            border-radius: 12px;
            padding: 24px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .job-card:hover {
            border-color: #667eea;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            transform: translateY(-2px);
        }

        .job-title {
            font-size: 20px;
            font-weight: 600;
            color: #2d3748;
            margin-bottom: 12px;
        }

        .job-meta {
            display: flex;
            flex-direction: column;
            gap: 8px;
            color: #718096;
            font-size: 14px;
        }

        .job-meta-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        /* Job Page */
        .job-page {
            display: none;
            min-height: 100vh;
        }

        .job-content {
            display: grid;
            grid-template-columns: 300px 1fr;
            gap: 40px;
            padding: 40px 0;
        }

        .job-sidebar {
            background: white;
            border-radius: 12px;
            padding: 24px;
            height: fit-content;
            border: 1px solid #e2e8f0;
        }

        .job-sidebar h3 {
            font-size: 16px;
            font-weight: 600;
            color: #2d3748;
            margin-bottom: 16px;
        }

        .job-sidebar-item {
            margin-bottom: 24px;
        }

        .job-sidebar-label {
            font-size: 14px;
            color: #718096;
            margin-bottom: 4px;
        }

        .job-sidebar-value {
            font-size: 16px;
            color: #2d3748;
            font-weight: 500;
        }

        .job-main {
            background: white;
            border-radius: 12px;
            padding: 32px;
            border: 1px solid #e2e8f0;
        }

        .job-header {
            border-bottom: 1px solid #e2e8f0;
            padding-bottom: 24px;
            margin-bottom: 32px;
        }

        .job-header h1 {
            font-size: 32px;
            font-weight: 700;
            color: #2d3748;
            margin-bottom: 16px;
        }

        .job-tabs {
            display: flex;
            gap: 32px;
        }

        .job-tab {
            padding: 12px 0;
            font-size: 16px;
            color: #718096;
            border-bottom: 2px solid transparent;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .job-tab.active {
            color: #2d3748;
            border-bottom-color: #667eea;
            font-weight: 500;
        }

        .job-description {
            line-height: 1.7;
            color: #4a5568;
            font-size: 16px;
        }

        .job-description h3 {
            font-size: 18px;
            font-weight: 600;
            color: #2d3748;
            margin: 24px 0 12px 0;
        }

        .job-description ul {
            margin: 16px 0;
            padding-left: 20px;
        }

        .job-description li {
            margin-bottom: 8px;
        }

        .apply-button {
            position: fixed;
            bottom: 24px;
            right: 24px;
            background: #4a5568;
            color: white;
            padding: 16px 32px;
            border: none;
            border-radius: 50px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            transition: all 0.2s ease;
        }

        .apply-button:hover {
            background: #2d3748;
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.2);
        }

        /* Application Form */
        .application-section {
            display: none;
            padding: 32px 0;
        }

        .application-form {
            max-width: 600px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            padding: 32px;
            border: 1px solid #e2e8f0;
        }

        .autofill-section {
            background: #f8fafc;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 32px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .autofill-text {
            color: #4a5568;
            font-size: 14px;
        }

        .upload-btn {
            background: white;
            border: 1px solid #e2e8f0;
            padding: 8px 16px;
            border-radius: 6px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .upload-btn:hover {
            border-color: #667eea;
        }

        .form-group {
            margin-bottom: 24px;
        }

        .form-label {
            display: block;
            font-size: 14px;
            font-weight: 500;
            color: #2d3748;
            margin-bottom: 8px;
        }

        .form-label.required::after {
            content: "*";
            color: #e53e3e;
            margin-left: 4px;
        }

        .form-input {
            width: 100%;
            padding: 12px 16px;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            font-size: 16px;
            transition: all 0.2s ease;
        }

        .form-input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .form-input.error {
            border-color: #e53e3e;
        }

        .error-message {
            color: #e53e3e;
            font-size: 12px;
            margin-top: 4px;
        }

        .file-upload-area {
            border: 2px dashed #e2e8f0;
            border-radius: 8px;
            padding: 40px 20px;
            text-align: center;
            transition: all 0.2s ease;
            cursor: pointer;
        }

        .file-upload-area:hover {
            border-color: #667eea;
            background: #f8fafc;
        }

        .file-upload-area.dragover {
            border-color: #667eea;
            background: #ebf4ff;
        }

        .submit-form-btn {
            width: 100%;
            background: #4a5568;
            color: white;
            padding: 16px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            margin-top: 24px;
        }

        .submit-form-btn:hover {
            background: #2d3748;
        }

        .submit-form-btn:disabled {
            background: #a0aec0;
            cursor: not-allowed;
        }

        /* Success Page */
        .success-page {
            display: none;
            text-align: center;
            padding: 80px 0;
        }

        .success-icon {
            width: 80px;
            height: 80px;
            background: #48bb78;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 24px;
            font-size: 32px;
            color: white;
        }

        .success-title {
            font-size: 32px;
            font-weight: 700;
            color: #2d3748;
            margin-bottom: 16px;
        }

        .success-message {
            font-size: 18px;
            color: #718096;
            margin-bottom: 32px;
        }

        .back-home-btn {
            background: #667eea;
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
            text-decoration: none;
            display: inline-block;
            transition: all 0.2s ease;
        }

        .back-home-btn:hover {
            background: #5a67d8;
        }

        /* Admin Dashboard - Hidden by default */
        .admin-dashboard {
            display: none;
            background: white;
            border-radius: 12px;
            padding: 32px;
            margin: 40px 0;
            border: 1px solid #e2e8f0;
        }

        .admin-dashboard.show {
            display: block;
        }

        .admin-toggle {
            position: fixed;
            bottom: 20px;
            left: 20px;
            background: #2d3748;
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 4px;
            font-size: 12px;
            cursor: pointer;
            z-index: 1000;
        }

        .admin-toggle:hover {
            background: #1a202c;
        }

        .admin-header {
            border-bottom: 1px solid #e2e8f0;
            padding-bottom: 16px;
            margin-bottom: 24px;
        }

        .admin-title {
            font-size: 24px;
            font-weight: 600;
            color: #2d3748;
        }

        .application-item {
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 16px;
            background: #f8fafc;
        }

        .application-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }

        .applicant-name {
            font-size: 18px;
            font-weight: 600;
            color: #2d3748;
        }

        .application-date {
            color: #718096;
            font-size: 14px;
        }

        .application-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 12px;
            font-size: 14px;
            color: #4a5568;
        }

        @media (max-width: 768px) {
            .job-content {
                grid-template-columns: 1fr;
            }

            .filters {
                flex-direction: column;
                align-items: stretch;
            }

            .jobs-grid {
                grid-template-columns: 1fr;
            }

            .hero-title {
                font-size: 36px;
            }

            .apply-button {
                position: static;
                width: 100%;
                margin-top: 24px;
                border-radius: 8px;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="container">
            <div class="header-content">
                <button class="back-arrow" id="backArrow">←</button>
                <a href="#" class="logo" id="logoLink">
                    <div class="logo-icon">
                        <img src="https://media.licdn.com/dms/image/v2/D560BAQFACW1mpJN9Vw/company-logo_100_100/company-logo_100_100/0/1733214511519/vooglamglasses_logo?e=1755734400&v=beta&t=0PeZVWG5jeGDf7TpZltAZEmgDXKrGW2HEbQP675_IGY" 
                             alt="Next Marvel Inc Logo"
                             onerror="this.style.display='none'; this.parentElement.innerHTML='&gt;&gt;';">
                    </div>
                    <span>Next Marvel Inc</span>
                </a>
                <div></div>
            </div>
        </div>
    </header>

    <div class="container">
        <!-- Home Page -->
        <div class="home-page" id="homePage">
            <!-- Hero Section -->
            <section class="hero-section">
                <h1 class="hero-title">Join Next Marvel Inc</h1>
                <p class="hero-subtitle">Help us revolutionize the eyewear industry. We're creating innovative eyewear solutions that combine cutting-edge technology with exceptional design to enhance how people see and experience the world.</p>
            </section>

            <!-- Filters Section -->
            <section class="filters-section">
                <div class="filters">
                    <div class="filter-group">
                        <label class="filter-label">Department</label>
                        <select class="filter-select" id="departmentFilter">
                            <option value="">All Departments</option>
                            <option value="Engineering">Engineering</option>
                            <option value="Product">Product</option>
                            <option value="Design">Design</option>
                            <option value="Research">Research</option>
                            <option value="Operations">Operations</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label class="filter-label">Employment Type</label>
                        <select class="filter-select" id="employmentFilter">
                            <option value="">All Types</option>
                            <option value="Full-time">Full-time</option>
                            <option value="Part-time">Part-time</option>
                            <option value="Contract">Contract</option>
                            <option value="Intern">Intern</option>
                        </select>
                    </div>
                </div>
            </section>

            <!-- Jobs Section -->
            <section class="jobs-section">
                <div class="jobs-grid" id="jobsGrid"></div>
            </section>
        </div>

        <!-- Job Page -->
        <div class="job-page" id="jobPage">
            <div class="job-content">
                <aside class="job-sidebar">
                    <div class="job-sidebar-item">
                        <div class="job-sidebar-label">Location</div>
                        <div class="job-sidebar-value" id="jobLocation"></div>
                    </div>
                    <div class="job-sidebar-item">
                        <div class="job-sidebar-label">Employment Type</div>
                        <div class="job-sidebar-value" id="jobEmploymentType"></div>
                    </div>
                    <div class="job-sidebar-item">
                        <div class="job-sidebar-label">Location Type</div>
                        <div class="job-sidebar-value" id="jobLocationType"></div>
                    </div>
                    <div class="job-sidebar-item">
                        <div class="job-sidebar-label">Department</div>
                        <div class="job-sidebar-value" id="jobDepartment"></div>
                    </div>
                </aside>

                <main class="job-main">
                    <div class="job-header">
                        <h1 id="jobTitle"></h1>
                        <div class="job-tabs">
                            <div class="job-tab active" data-tab="overview">Overview</div>
                            <div class="job-tab" data-tab="application">Application</div>
                        </div>
                    </div>

                    <div class="job-tab-content" id="overviewContent">
                        <div class="job-description" id="jobDescription"></div>
                    </div>

                    <div class="job-tab-content application-section" id="applicationContent">
                        <div class="application-form">
                            <div class="autofill-section">
                                <div>
                                    <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 4px;">
                                        <span>🪄</span>
                                        <strong>Autofill from resume</strong>
                                    </div>
                                    <div class="autofill-text">Upload your resume here to autofill key application fields.</div>
                                </div>
                                <button class="upload-btn" id="autofillBtn">Upload file</button>
                            </div>

                            <form id="applicationForm">
                                <div class="form-group">
                                    <label class="form-label required">Name</label>
                                    <input type="text" class="form-input" id="applicantName" placeholder="Type here..." required>
                                    <div class="error-message" id="nameError"></div>
                                </div>

                                <div class="form-group">
                                    <label class="form-label required">Email</label>
                                    <input type="email" class="form-input" id="applicantEmail" placeholder="hello@example.com..." required>
                                    <div class="error-message" id="emailError"></div>
                                </div>

                                <div class="form-group">
                                    <label class="form-label required">Resume</label>
                                    <div class="file-upload-area" id="resumeUpload">
                                        <div>📎 Upload File or drag and drop here</div>
                                        <input type="file" id="resumeFile" accept=".pdf,.doc,.docx" style="display: none;" required>
                                    </div>
                                    <div class="error-message" id="resumeError"></div>
                                </div>

                                <div class="form-group">
                                    <label class="form-label required">Location</label>
                                    <input type="text" class="form-input" id="applicantLocation" placeholder="City, Country" required>
                                    <div class="error-message" id="locationError"></div>
                                </div>

                                <div class="form-group">
                                    <label class="form-label">Phone Number</label>
                                    <input type="tel" class="form-input" id="applicantPhone" placeholder="+1 (555) 123-4567">
                                </div>

                                <div class="form-group">
                                    <label class="form-label">Cover Letter</label>
                                    <textarea class="form-input" id="coverLetter" rows="6" placeholder="Tell us why you're interested in this position..."></textarea>
                                </div>

                                <button type="submit" class="submit-form-btn" id="submitBtn">Submit Application</button>
                            </form>
                        </div>
                    </div>
                </main>
            </div>

            <button class="apply-button" id="applyButton">Apply for this Job</button>
        </div>

        <!-- Success Page -->
        <div class="success-page" id="successPage">
            <div class="success-icon">✓</div>
            <h1 class="success-title">Application Submitted!</h1>
            <p class="success-message">Thank you for your application. We'll review it and get back to you soon.</p>
            <a href="#" class="back-home-btn" id="backHomeBtn">Back to Jobs</a>
        </div>

        <!-- Admin Dashboard - Hidden from users -->
        <div class="admin-dashboard" id="adminDashboard">
            <div class="admin-header">
                <h2 class="admin-title">📊 Application Dashboard</h2>
            </div>
            <div id="applicationsList">
                <p style="text-align: center; color: #718096; padding: 40px;">No applications received yet.</p>
            </div>
        </div>

        <!-- Admin Toggle (remove this line for production) -->
        <!-- <button class="admin-toggle" id="adminToggle" onclick="toggleAdmin()">Admin</button> -->
    </div>

    <script>
        // Google Sheets Configuration
        const GOOGLE_SHEETS_CONFIG = {
            // Google Apps Script Web App URL - This is all you need!
            WEB_APP_URL: 'https://script.google.com/macros/s/AKfycbwazXsAI5k3v8BUUnjUtJnDsqV1R5BxDMTPSrq94_04Lm2UqGJMymvqapRRAPHZ_hiU/exec'
        };

        // Job data
        const jobsData = [
            {
                id: 1,
                title: "Senior Front-End Engineer",
                department: "Engineering",
                location: "Toronto, Canada, Ottawa, Montreal, Vancouver, New York",
                employmentType: "Full-time",
                locationType: "Hybrid",
                description: `
                    <h3>Who are we?</h3>
                    <p>Our mission is to revolutionize the eyewear industry through innovative design, advanced materials, and cutting-edge technology. We're creating eyewear solutions that not only provide exceptional vision correction but also integrate seamlessly with modern lifestyles, from smart frames to sustainable materials.</p>
                    
                    <p>We obsess over every detail. Each team member is responsible for contributing to our mission of creating eyewear that makes a real difference in people's lives. We combine traditional craftsmanship with modern technology to deliver products that exceed expectations.</p>
                    
                    <p>Next Marvel Inc is a team of designers, engineers, opticians, materials scientists, and visionaries who are passionate about their craft. Each person brings unique expertise to help us push the boundaries of what eyewear can be. We believe that diverse perspectives are essential for creating revolutionary products.</p>
                    
                    <p>Join us on our mission to shape the future of vision!</p>
                    
                    <h3>About Our Innovation:</h3>
                    <p>Our eyewear platform combines advanced lens technology, smart frame integration, and sustainable manufacturing processes. We offer customizable solutions that adapt to individual needs while maintaining the highest standards of quality, comfort, and style. Our products integrate cutting-edge features like blue light filtering, photochromic technology, and even smart connectivity.</p>
                    
                    <h3>Full-Time Employees at Next Marvel Inc enjoy these Perks:</h3>
                    <ul>
                        <li>🤝 An open and inclusive culture and work environment</li>
                        <li>👓 Comprehensive eyewear benefits - free frames and lenses for you and your family</li>
                        <li>🔬 Work with cutting-edge eyewear technology and innovative materials</li>
                        <li>🍽️ Weekly lunch stipend, in-office meals & snacks</li>
                        <li>🏥 Comprehensive health and vision benefits, including mental health support</li>
                        <li>👶 Generous parental leave policies</li>
                        <li>🎨 Professional development budget for courses, conferences, and certifications</li>
                        <li>🏢 Flexible work arrangements with modern office spaces and co-working allowances</li>
                        <li>✈️ Generous vacation time and flexible PTO</li>
                        <li>💰 Competitive salary and equity packages</li>
                        <li>🎯 Performance bonuses and recognition programs</li>
                        <li>🌱 Sustainability initiatives and green commuting benefits</li>
                    </ul>
                    
                    <p><em>Next Marvel Inc is an equal opportunity employer committed to diversity and inclusion in the eyewear industry.</em></p>
                `
            },
            {
                id: 2,
                title: "Product Manager",
                department: "Product",
                location: "San Francisco, CA",
                employmentType: "Full-time",
                locationType: "Hybrid",
                description: `
                    <h3>Who are we?</h3>
                    <p>Our mission is to scale intelligence to serve humanity. Join our product team to help shape the future of AI technology and drive product strategy for millions of users worldwide.</p>
                    
                    <h3>What you'll do:</h3>
                    <ul>
                        <li>Define product roadmap and strategy</li>
                        <li>Work closely with engineering and design teams</li>
                        <li>Analyze user data and market trends</li>
                        <li>Lead cross-functional initiatives</li>
                    </ul>
                `
            },
            {
                id: 3,
                title: "UX Designer",
                department: "Design",
                location: "New York, NY",
                employmentType: "Full-time",
                locationType: "Remote",
                description: `
                    <h3>About the role:</h3>
                    <p>Join our design team to create beautiful, intuitive experiences that make AI accessible to everyone. You'll work on cutting-edge interfaces that thousands of users interact with daily.</p>
                    
                    <h3>What you'll do:</h3>
                    <ul>
                        <li>Design user interfaces for web and mobile</li>
                        <li>Conduct user research and usability testing</li>
                        <li>Collaborate with product and engineering teams</li>
                        <li>Create design systems and prototypes</li>
                    </ul>
                `
            },
            {
                id: 4,
                title: "Research Scientist",
                department: "Research",
                location: "Toronto, Canada",
                employmentType: "Full-time",
                locationType: "Hybrid",
                description: `
                    <h3>Join our research team:</h3>
                    <p>Work on fundamental AI research that pushes the boundaries of what's possible. You'll contribute to breakthrough research in large language models and AI safety.</p>
                    
                    <h3>What you'll do:</h3>
                    <ul>
                        <li>Conduct cutting-edge AI research</li>
                        <li>Publish papers at top-tier conferences</li>
                        <li>Collaborate with international research teams</li>
                        <li>Develop novel training techniques</li>
                    </ul>
                `
            },
            {
                id: 5,
                title: "DevOps Engineer",
                department: "Operations",
                location: "Remote",
                employmentType: "Contract",
                locationType: "Remote",
                description: `
                    <h3>Infrastructure at scale:</h3>
                    <p>Help us build and maintain the infrastructure that powers our AI models. You'll work on systems that serve millions of requests per day.</p>
                    
                    <h3>What you'll do:</h3>
                    <ul>
                        <li>Manage cloud infrastructure</li>
                        <li>Implement CI/CD pipelines</li>
                        <li>Monitor system performance</li>
                        <li>Ensure security and compliance</li>
                    </ul>
                `
            }
        ];

        // Application storage (fallback for offline)
        let applications = JSON.parse(localStorage.getItem('applications')) || [];
        let currentJob = null;

        // Google Sheets API Functions
        async function submitToGoogleSheets(applicationData) {
            try {
                // Method 1: Using Google Apps Script Web App (Recommended - Easier Setup)
                if (GOOGLE_SHEETS_CONFIG.WEB_APP_URL && GOOGLE_SHEETS_CONFIG.WEB_APP_URL !== 'YOUR_GOOGLE_APPS_SCRIPT_WEB_APP_URL_HERE') {
                    const response = await fetch(GOOGLE_SHEETS_CONFIG.WEB_APP_URL, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify(applicationData)
                    });
                    
                    if (response.ok) {
                        console.log('✅ Application sent to Google Sheets successfully');
                        return true;
                    } else {
                        throw new Error('Failed to submit to Google Sheets');
                    }
                }
                
                // Method 2: Direct Sheets API (Requires more setup)
                else if (GOOGLE_SHEETS_CONFIG.API_KEY && GOOGLE_SHEETS_CONFIG.API_KEY !== 'YOUR_GOOGLE_API_KEY_HERE') {
                    const values = [
                        [
                            applicationData.submittedAtFormatted,
                            applicationData.jobTitle,
                            applicationData.name,
                            applicationData.email,
                            applicationData.phone || '',
                            applicationData.location,
                            applicationData.coverLetter || '',
                            applicationData.resumeFileName,
                            applicationData.submittedAt,
                            'New',
                            `ID: ${applicationData.id}`
                        ]
                    ];

                    const response = await fetch(
                        `https://sheets.googleapis.com/v4/spreadsheets/${GOOGLE_SHEETS_CONFIG.SHEET_ID}/values/${GOOGLE_SHEETS_CONFIG.RANGE}:append?valueInputOption=RAW&key=${GOOGLE_SHEETS_CONFIG.API_KEY}`,
                        {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json',
                            },
                            body: JSON.stringify({ values })
                        }
                    );

                    if (response.ok) {
                        console.log('✅ Application sent to Google Sheets successfully');
                        return true;
                    } else {
                        throw new Error('Failed to submit to Google Sheets');
                    }
                }
                
                // No Google Sheets configured
                else {
                    console.log('⚠️ Google Sheets not configured, saving locally only');
                    return false;
                }
                
            } catch (error) {
                console.error('❌ Error submitting to Google Sheets:', error);
                return false;
            }
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            renderJobs();
            updateApplicationsList();
            setupEventListeners();
        });

        function setupEventListeners() {
            // Navigation
            document.getElementById('backArrow').addEventListener('click', showHomePage);
            document.getElementById('logoLink').addEventListener('click', function(e) {
                e.preventDefault();
                showHomePage();
            });
            document.getElementById('backHomeBtn').addEventListener('click', function(e) {
                e.preventDefault();
                showHomePage();
            });

            // Filters
            document.getElementById('departmentFilter').addEventListener('change', filterJobs);
            document.getElementById('employmentFilter').addEventListener('change', filterJobs);

            // Job tabs
            document.querySelectorAll('.job-tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    switchTab(this.dataset.tab);
                });
            });

            // Apply button
            document.getElementById('applyButton').addEventListener('click', function() {
                switchTab('application');
            });

            // File uploads
            setupFileUpload();

            // Form submission - FIXED
            const form = document.getElementById('applicationForm');
            if (form) {
                form.addEventListener('submit', handleFormSubmit);
                console.log('✅ Form event listener attached');
            } else {
                console.error('❌ Application form not found!');
            }
        }

        function renderJobs(filter = {}) {
            const jobsGrid = document.getElementById('jobsGrid');
            let filteredJobs = jobsData;

            if (filter.department) {
                filteredJobs = filteredJobs.filter(job => job.department === filter.department);
            }

            if (filter.employmentType) {
                filteredJobs = filteredJobs.filter(job => job.employmentType === filter.employmentType);
            }

            jobsGrid.innerHTML = filteredJobs.map(job => `
                <div class="job-card" onclick="showJobPage(${job.id})">
                    <h3 class="job-title">${job.title}</h3>
                    <div class="job-meta">
                        <div class="job-meta-item">
                            <span>📍</span>
                            <span>${job.location}</span>
                        </div>
                        <div class="job-meta-item">
                            <span>💼</span>
                            <span>${job.employmentType}</span>
                        </div>
                        <div class="job-meta-item">
                            <span>🏠</span>
                            <span>${job.locationType}</span>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function filterJobs() {
            const department = document.getElementById('departmentFilter').value;
            const employmentType = document.getElementById('employmentFilter').value;
            
            renderJobs({ department, employmentType });
        }

        function showHomePage() {
            document.getElementById('homePage').style.display = 'block';
            document.getElementById('jobPage').style.display = 'none';
            document.getElementById('successPage').style.display = 'none';
            document.getElementById('backArrow').style.display = 'none';
            currentJob = null;
        }

        function showJobPage(jobId) {
            currentJob = jobsData.find(job => job.id === jobId);
            if (!currentJob) return;

            // Update sidebar
            document.getElementById('jobLocation').textContent = currentJob.location;
            document.getElementById('jobEmploymentType').textContent = currentJob.employmentType;
            document.getElementById('jobLocationType').textContent = currentJob.locationType;
            document.getElementById('jobDepartment').textContent = currentJob.department;

            // Update main content
            document.getElementById('jobTitle').textContent = currentJob.title;
            document.getElementById('jobDescription').innerHTML = currentJob.description;

            // Show job page
            document.getElementById('homePage').style.display = 'none';
            document.getElementById('jobPage').style.display = 'block';
            document.getElementById('successPage').style.display = 'none';
            document.getElementById('backArrow').style.display = 'block';

            // Reset to overview tab
            switchTab('overview');
        }

        function switchTab(tabName) {
            // Update tab appearance
            document.querySelectorAll('.job-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelector(`[data-tab="${tabName}"]`).classList.add('active');

            // Show/hide content
            if (tabName === 'overview') {
                document.getElementById('overviewContent').style.display = 'block';
                document.getElementById('applicationContent').style.display = 'none';
                document.getElementById('applyButton').style.display = 'block';
            } else {
                document.getElementById('overviewContent').style.display = 'none';
                document.getElementById('applicationContent').style.display = 'block';
                document.getElementById('applyButton').style.display = 'none';
            }
        }

        function setupFileUpload() {
            const resumeUpload = document.getElementById('resumeUpload');
            const resumeFile = document.getElementById('resumeFile');

            resumeUpload.addEventListener('click', () => resumeFile.click());

            resumeUpload.addEventListener('dragover', function(e) {
                e.preventDefault();
                this.classList.add('dragover');
            });

            resumeUpload.addEventListener('dragleave', function(e) {
                e.preventDefault();
                this.classList.remove('dragover');
            });

            resumeUpload.addEventListener('drop', function(e) {
                e.preventDefault();
                this.classList.remove('dragover');
                const files = e.dataTransfer.files;
                if (files.length > 0) {
                    resumeFile.files = files;
                    updateFileDisplay(files[0]);
                }
            });

            resumeFile.addEventListener('change', function() {
                if (this.files.length > 0) {
                    updateFileDisplay(this.files[0]);
                }
            });

            document.getElementById('autofillBtn').addEventListener('click', () => resumeFile.click());
        }

        function updateFileDisplay(file) {
            const uploadArea = document.getElementById('resumeUpload');
            uploadArea.innerHTML = `<div>📄 ${file.name}</div>`;
        }

        function validateForm() {
            let isValid = true;
            const errors = {};

            // Clear previous errors
            document.querySelectorAll('.form-input').forEach(input => {
                input.classList.remove('error');
            });
            document.querySelectorAll('.error-message').forEach(error => {
                error.textContent = '';
            });

            // Validate name
            const name = document.getElementById('applicantName').value.trim();
            if (!name) {
                errors.name = 'Name is required';
                isValid = false;
            }

            // Validate email
            const email = document.getElementById('applicantEmail').value.trim();
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!email) {
                errors.email = 'Email is required';
                isValid = false;
            } else if (!emailRegex.test(email)) {
                errors.email = 'Please enter a valid email address';
                isValid = false;
            }

            // Validate resume
            const resume = document.getElementById('resumeFile').files[0];
            if (!resume) {
                errors.resume = 'Resume is required';
                isValid = false;
            }

            // Validate location
            const location = document.getElementById('applicantLocation').value.trim();
            if (!location) {
                errors.location = 'Location is required';
                isValid = false;
            }

            // Display errors
            Object.keys(errors).forEach(field => {
                const input = document.getElementById(`applicant${field.charAt(0).toUpperCase() + field.slice(1)}`) || 
                              document.getElementById(`${field}File`) ||
                              document.getElementById(`applicant${field.charAt(0).toUpperCase() + field.slice(1)}`);
                
                if (input) {
                    input.classList.add('error');
                }
                
                const errorElement = document.getElementById(`${field}Error`);
                if (errorElement) {
                    errorElement.textContent = errors[field];
                }
            });

            return isValid;
        }

        async function handleFormSubmit(e) {
            console.log('🚀 Form submitted!');
            e.preventDefault();

            if (!validateForm()) {
                console.log('❌ Form validation failed');
                return;
            }

            console.log('✅ Form validation passed');

            // Disable submit button to prevent double submission
            const submitBtn = document.getElementById('submitBtn');
            submitBtn.disabled = true;
            submitBtn.textContent = 'Submitting...';

            // Collect form data
            const formData = {
                id: Date.now(),
                jobId: currentJob ? currentJob.id : 1,
                jobTitle: currentJob ? currentJob.title : 'Unknown Position',
                name: document.getElementById('applicantName').value.trim(),
                email: document.getElementById('applicantEmail').value.trim(),
                location: document.getElementById('applicantLocation').value.trim(),
                phone: document.getElementById('applicantPhone').value.trim(),
                coverLetter: document.getElementById('coverLetter').value.trim(),
                resumeFileName: document.getElementById('resumeFile').files[0]?.name || 'No file uploaded',
                submittedAt: new Date().toISOString(),
                submittedAtFormatted: new Date().toLocaleDateString('en-US', {
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric',
                    hour: '2-digit',
                    minute: '2-digit'
                })
            };

            console.log('📝 Form data collected:', formData);

            try {
                // Try to submit to Google Sheets first
                console.log('📤 Attempting to submit to Google Sheets...');
                const sheetsSuccess = await submitToGoogleSheets(formData);
                
                // Always save locally as backup
                applications.push(formData);
                localStorage.setItem('applications', JSON.stringify(applications));
                console.log('💾 Application saved locally');

                // Update admin dashboard (hidden from user)
                updateApplicationsList();

                // Reset form
                document.getElementById('applicationForm').reset();
                const resumeUpload = document.getElementById('resumeUpload');
                if (resumeUpload) {
                    resumeUpload.innerHTML = '<div>📎 Upload File or drag and drop here</div>';
                }

                // Show success page
                showSuccessPage();

                if (sheetsSuccess) {
                    console.log('✅ Application successfully saved to Google Sheets and locally');
                } else {
                    console.log('⚠️ Application saved locally only (Google Sheets not configured)');
                }

            } catch (error) {
                console.error('❌ Error submitting application:', error);
                
                // Still save locally as fallback
                applications.push(formData);
                localStorage.setItem('applications', JSON.stringify(applications));
                updateApplicationsList();
                
                // Show success page anyway (user doesn't need to know about backend issues)
                showSuccessPage();
            }

            // Re-enable submit button
            submitBtn.disabled = false;
            submitBtn.textContent = 'Submit Application';
        }

        // Admin functions (hidden from regular users)
        function toggleAdmin() {
            const dashboard = document.getElementById('adminDashboard');
            dashboard.classList.toggle('show');
        }

        // Hide admin toggle in production (you can remove this line for testing)
        // document.getElementById('adminToggle').style.display = 'none';

        function showSuccessPage() {
            document.getElementById('homePage').style.display = 'none';
            document.getElementById('jobPage').style.display = 'none';
            document.getElementById('successPage').style.display = 'block';
            document.getElementById('backArrow').style.display = 'none';
        }

        function updateApplicationsList() {
            const applicationsList = document.getElementById('applicationsList');
            
            if (applications.length === 0) {
                applicationsList.innerHTML = '<p style="text-align: center; color: #718096; padding: 40px;">No applications received yet.</p>';
                return;
            }

            applicationsList.innerHTML = applications.map(app => `
                <div class="application-item">
                    <div class="application-header">
                        <div class="applicant-name">${app.name}</div>
                        <div class="application-date">${app.submittedAtFormatted}</div>
                    </div>
                    <div class="application-details">
                        <div><strong>Position:</strong> ${app.jobTitle}</div>
                        <div><strong>Email:</strong> ${app.email}</div>
                        <div><strong>Location:</strong> ${app.location}</div>
                        <div><strong>Phone:</strong> ${app.phone || 'Not provided'}</div>
                        <div><strong>Resume:</strong> ${app.resumeFileName}</div>
                        ${app.coverLetter ? `<div style="grid-column: 1 / -1; margin-top: 8px;"><strong>Cover Letter:</strong><br>${app.coverLetter}</div>` : ''}
                    </div>
                </div>
            `).reverse().join('');
        }
    </script>
</body>
</html>
